<!doctype html>
<html>
<head>
    <title>MoCIoT</title>
</head>

<body>
    <div class="status"></div>

    <div>
        <div><span>X: </span><span class="gyro-x"></span></div>
        <div><span>Y: </span><span class="gyro-y"></span></div>
        <div><span>Z: </span><span class="gyro-z"></span></div>
    </div>


<script src="jquery-3.6.3.min.js"></script>

<script>
    function startGyro() {
        stat.html("works :O")
        let gyroscope = new Gyroscope({frequency: 60});

        gyroscope.addEventListener('reading', (e) => {
            $(".gyro-x").html("oeihwfwef")
            $(".gyro-x").html(gyroscope.x)
            $(".gyro-y").html(gyroscope.y)
            $(".gyro-z").html(gyroscope.z)
        });
        gyroscope.onerror = (event) => {
            // Handle runtime errors.
            if (event.error.name === 'NotAllowedError') {
                stat.html('Permission to access sensor was denied.');
            } else if (event.error.name === 'NotReadableError') {
                stat.html('Cannot connect to the sensor.');
            }
        };
        gyroscope.start();
    }

    let stat = $(".status");
    stat.html("requesting permission")

    navigator.permissions.query({name:'gyroscope'}).then(function(result) {
        if (result.state == 'granted') {
            startGyro();
        } else if (result.state == 'prompt') {
            stat.html("prompt")
        } else if (result.state == 'denied') {
            stat.html("denied")
        }
    });
</script>

</body>

</html>
